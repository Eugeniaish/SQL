SELECT accounts.name, 
	SUM(CASE WHEN channel = 'direct' THEN 1 ELSE 0 END) AS direct,
	SUM(CASE WHEN channel = 'facebook' THEN 1 ELSE 0 END) AS facebook,
	SUM(CASE WHEN channel = 'twitter' THEN 1 ELSE 0 END) AS twitter,
	SUM(CASE WHEN channel = 'organic' THEN 1 ELSE 0 END) AS organic,
	SUM(CASE WHEN channel = 'adwords' THEN 1 ELSE 0 END) AS adwords,
	SUM(CASE WHEN channel = 'banner' THEN 1 ELSE 0 END) AS banner,
	COUNT(*) AS total
FROM web_events
JOIN accounts ON web_events.account_id = accounts.id
GROUP BY accounts.name
ORDER BY total DESC;
Description:
Shows total web events per account broken down by channel type.
